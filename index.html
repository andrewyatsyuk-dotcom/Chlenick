<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–í–∏—Ä–æ—â—É–≤–∞–π –ß–ª–µ–Ω</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { margin:0; padding:0; overflow:hidden; background:var(--tg-theme-bg-color,#111); font-family:sans-serif; color:var(--tg-theme-text-color,#fff); }
        canvas { display:block; }
        .ui { position:absolute; top:0; left:0; width:100%; height:100%; pointer-events:none; }
        .info { position:absolute; top:15px; left:15px; font-size:20px; text-shadow:0 0 5px #000; pointer-events:auto; }
        .buttons { position:absolute; bottom:20px; left:50%; transform:translateX(-50%); display:flex; gap:15px; pointer-events:auto; }
        button { padding:15px 25px; font-size:18px; border:none; border-radius:12px; background:var(--tg-theme-button-color,#2481cc); color:#fff; box-shadow:0 4px 15px rgba(0,0,0,0.3); }
        #length { font-size:28px; font-weight:bold; margin:10px 0; }
    </style>
</head>
<body>
    <canvas id="c"></canvas>
    
    <div class="ui">
        <div class="info">
            <div id="length">–ß–ª–µ–Ω: 5.0 —Å–º</div>
            <div id="status">–†–æ—Å—Ç–µ...</div>
        </div>
        
        <div class="buttons">
            <button id="water">üíß –ü—ñ–¥–ª–∏—Ç–∏</button>
            <button id="shave">‚úÇÔ∏è –ü–æ–±—Ä–∏—Ç–∏</button>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();
        tg.MainButton.setText("–ü–æ–¥—ñ–ª–∏—Ç–∏—Å—å —á–ª–µ–Ω–æ–º üî•").show();
        
        const canvas = document.getElementById('c');
        const ctx = canvas.getContext('2d');
        
        let w = canvas.width = window.innerWidth;
        let h = canvas.height = window.innerHeight;
        
        // –î–∞–Ω—ñ –≥—Ä–∏
        let length = 5;           // –ø–æ—Ç–æ—á–Ω–∞ –¥–æ–≤–∂–∏–Ω–∞ –≤ —Å–º
        let lastTime = Date.now();
        let waterBoostEnd = 0;    // timestamp –∫–æ–ª–∏ –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è –±—É—Å—Ç –≤—ñ–¥ –ø—ñ–¥–ª–∏–≤–∞–Ω–Ω—è
        let shaveBoostEnd = 0;    // timestamp –∫–æ–ª–∏ –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è –±—É—Å—Ç –≤—ñ–¥ –≥–æ–ª—ñ–Ω–Ω—è
        let hair = true;          // —á–∏ —î –≤–æ–ª–æ—Å—Å—è (–≤–ø–ª–∏–≤–∞—î –Ω–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å)

        // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—É
        if (localStorage.getItem('penisGame')) {
            const saved = JSON.parse(localStorage.getItem('penisGame'));
            length = saved.length || 5;
            lastTime = saved.lastTime || Date.now();
            waterBoostEnd = saved.waterBoostEnd || 0;
            shaveBoostEnd = saved.shaveBoostEnd || 0;
            hair = saved.hair !== false;
        }

        // –û—Ñ–ª–∞–π–Ω-–ø—Ä–æ–≥—Ä–µ—Å
        function calculateOffline() {
            const now = Date.now();
            const secondsPassed = (now - lastTime) / 1000;
            let rate = 0.0008; // \~2.88 —Å–º –∑–∞ –≥–æ–¥–∏–Ω—É –±–∞–∑–æ–≤–æ
            
            if (now < waterBoostEnd) rate *= 3;
            if (now < shaveBoostEnd) rate *= 2.5;
            if (!hair) rate *= 1.4;
            
            length += secondsPassed * rate;
            if (length > 60) length = 60; // –º–∞–∫—Å–∏–º—É–º 60 —Å–º
            
            lastTime = now;
            saveGame();
        }

        function saveGame() {
            localStorage.setItem('penisGame', JSON.stringify({
                length, lastTime, waterBoostEnd, shaveBoostEnd, hair
            }));
        }

        // –ú–∞–ª—é—î–º–æ —á–ª–µ–Ω (–≤ —Å—Ç–∏–ª—ñ –ø—ñ–∫—Å–µ–ª—å-–∞—Ä—Ç—É –∑ —Ç–≤–æ—î—ó –∫–∞—Ä—Ç–∏–Ω–∫–∏)
        function draw() {
            ctx.clearRect(0, 0, w, h);
            
            // –¢–ª–æ (–Ω–µ–±–æ + —Ç—Ä–∞–≤–∞)
            ctx.fillStyle = '#87CEEB';
            ctx.fillRect(0, 0, w, h*0.6);
            ctx.fillStyle = '#4CAF50';
            ctx.fillRect(0, h*0.6, w, h);
            
            // –°–æ–Ω—Ü–µ/—Ö–º–∞—Ä–∏ (–ø—Ä–æ—Å—Ç–æ –¥–ª—è –∫—Ä–∞—Å–∏)
            ctx.fillStyle = '#FFEB3B';
            ctx.beginPath(); ctx.arc(w*0.8, h*0.15, 40, 0, Math.PI*2); ctx.fill();
            
            // –ß–ª–µ–Ω
            const scale = Math.min(1, length / 30); // –º–∞—Å—à—Ç–∞–± –≤—ñ–¥ 5 –¥–æ 60 —Å–º
            const penisHeight = 180 + scale * 280;   // –≤—ñ–¥ 180px –¥–æ \~460px
            const centerX = w / 2;
            const baseY = h * 0.75;
            
            // –Ø–π—Ü—è
            ctx.fillStyle = '#C68642';
            ctx.beginPath();
            ctx.ellipse(centerX - 28, baseY + 20, 32, 25, 0, 0, Math.PI*2);
            ctx.ellipse(centerX + 28, baseY + 20, 32, 25, 0, 0, Math.PI*2);
            ctx.fill();
            
            // –°—Ç–≤–æ–ª
            ctx.fillStyle = '#D38E5F';
            ctx.fillRect(centerX - 22, baseY - penisHeight + 30, 44, penisHeight);
            
            // –ì–æ–ª–æ–≤–∫–∞
            ctx.fillStyle = '#E07A5F';
            ctx.beginPath();
            ctx.ellipse(centerX, baseY - penisHeight + 25, 26, 18, 0, 0, Math.PI*2);
            ctx.fill();
            
            // –ë–ª–∏—Å–∫ –Ω–∞ –≥–æ–ª–æ–≤—Ü—ñ
            ctx.fillStyle = 'rgba(255,255,255,0.4)';
            ctx.beginPath();
            ctx.ellipse(centerX-8, baseY - penisHeight + 22, 10, 6, 0, 0, Math.PI*2);
            ctx.fill();
            
            // –í–æ–ª–æ—Å—Å—è (—è–∫—â–æ —î)
            if (hair && length > 8) {
                ctx.strokeStyle = '#3D2B1F';
                ctx.lineWidth = 6;
                for (let i = -20; i <= 20; i += 8) {
                    ctx.beginPath();
                    ctx.moveTo(centerX + i, baseY - 40);
                    ctx.lineTo(centerX + i + (Math.random()*6-3), baseY - 80);
                    ctx.stroke();
                }
            }
            
            // –¢—Ä–∞–≤–∞ –∑–Ω–∏–∑—É
            ctx.fillStyle = '#2E7D32';
            ctx.fillRect(0, baseY + 45, w, h - baseY - 45);
        }

        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–∂–Ω—É —Å–µ–∫—É–Ω–¥—É
        function loop() {
            calculateOffline();
            
            const now = Date.now();
            let status = "–†–æ—Å—Ç–µ —Å–∞–º –ø–æ —Å–æ–±—ñ...";
            
            if (now < waterBoostEnd) status = "üíß –ü—ñ–¥—Å–∏–ª–µ–Ω–∏–π –ø–æ–ª–∏–≤–æ–º!";
            else if (now < shaveBoostEnd) status = "‚úÇÔ∏è –ü—ñ—Å–ª—è –≥–æ–ª—ñ–Ω–Ω—è —Ä–æ—Å—Ç–µ —à–≤–∏–¥—à–µ!";
            else if (!hair) status = "–ì–æ–ª–∏–π = —Ä–æ—Å—Ç–µ —à–≤–∏–¥—à–µ!";
            
            document.getElementById('length').textContent = `–ß–ª–µ–Ω: ${length.toFixed(1)} —Å–º`;
            document.getElementById('status').textContent = status;
            
            draw();
            requestAnimationFrame(loop);
        }

        // –ö–Ω–æ–ø–∫–∏
        document.getElementById('water').addEventListener('click', () => {
            tg.HapticFeedback.impactOccurred('heavy');
            
            const now = Date.now();
            length += 3.5;                    // –≤–µ–ª–∏–∫–∏–π –º–∏—Ç—Ç—î–≤–∏–π –±–æ–Ω—É—Å
            waterBoostEnd = now + 4 * 60 * 60 * 1000; // +4 –≥–æ–¥–∏–Ω–∏ –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è √ó3
            
            if (length > 60) length = 60;
            saveGame();
        });

        document.getElementById('shave').addEventListener('click', () => {
            tg.HapticFeedback.impactOccurred('medium');
            
            length += 1.8;
            hair = false;
            shaveBoostEnd = Date.now() + 2 * 60 * 60 * 1000; // +2 –≥–æ–¥–∏–Ω–∏ –ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è √ó2.5
            
            // –í–æ–ª–æ—Å—Å—è –≤—ñ–¥—Ä–æ—Å—Ç–∞—î —á–µ—Ä–µ–∑ 30 —Ö–≤–∏–ª–∏–Ω –ø—ñ—Å–ª—è –≥–æ–ª—ñ–Ω–Ω—è
            setTimeout(() => { hair = true; saveGame(); }, 30 * 60 * 1000);
            
            if (length > 60) length = 60;
            saveGame();
        });

        // –ü–æ–¥—ñ–ª–∏—Ç–∏—Å—å —á–µ—Ä–µ–∑ Telegram
        tg.MainButton.onClick(() => {
            tg.sendData(JSON.stringify({ length: length.toFixed(1), action: "share" }));
            tg.showAlert(`–¢–≤—ñ–π —á–ª–µ–Ω ${length.toFixed(1)} —Å–º üî•\n–ü–æ–¥—ñ–ª–∏—Å—å –∑ –¥—Ä—É–∑—è–º–∏!`);
        });

        // –°—Ç–∞—Ä—Ç
        calculateOffline();
        loop();

        // –ê–¥–∞–ø—Ç–∞—Ü—ñ—è –ø—ñ–¥ –∑–º—ñ–Ω—É —Ä–æ–∑–º—ñ—Ä—É –≤—ñ–∫–Ω–∞
        window.addEventListener('resize', () => {
            w = canvas.width = window.innerWidth;
            h = canvas.height = window.innerHeight;
        });
    </script>
</body>
</html>
